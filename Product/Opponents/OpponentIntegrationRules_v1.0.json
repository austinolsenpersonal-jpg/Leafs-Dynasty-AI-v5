{
  "version": "1.0",
  "description": "Integration rules that connect OpponentArchetypeMap_v1.0 and OpponentScoutPack_v1.0 to gameplans, matchup cards, and runtime snapshots for Leafs Dynasty AI.",
  "sources": {
    "archetype_map_path": "Product/Opponents/OpponentArchetypeMap_v1.0.json",
    "scout_pack_path": "Product/Opponents/OpponentScoutPack_v1.0.json"
  },
  "global_flags": {
    "use_scout_pack_for_gameplans": true,
    "use_scout_pack_for_matchups": true,
    "use_scout_pack_for_runtime_snapshots": true,
    "fallback_archetype_if_missing_scout_data": "balanced_depth"
  },
  "priority_order": [
    "archetype_map",
    "scout_pack",
    "manual_overrides"
  ],
  "gameplan_integration": {
    "notes": "These rules describe how to turn scouting data into system biases and slider tendencies. They are descriptive, not code.",
    "weights": {
      "systems_profile": 0.4,
      "special_teams_profile": 0.2,
      "goalie_profile": 0.15,
      "physicality_profile": 0.15,
      "event_profile": 0.1
    },
    "derived_settings": {
      "forecheck_profile": {
        "source_fields": [
          "systems_profile.forecheck_pressure",
          "systems_profile.rush_offence",
          "event_profile.event_rate"
        ],
        "target_field": "team_strategies.forecheck",
        "logic_hint": "High forecheck_pressure and rush_offence lean toward 1-2-2 Aggressive / 2-3. Low forecheck_pressure with low event_rate leans toward 1-2-2 Passive or trap-heavy setups."
      },
      "neutral_zone_profile": {
        "source_fields": [
          "systems_profile.neutral_zone_trap_strength",
          "event_profile.event_rate"
        ],
        "target_field": "team_strategies.neutral_zone",
        "logic_hint": "High trap_strength and low event_rate push toward 1-3-1 or 1-2-2 Blue. Lower trap_strength with higher event_rate allows more aggressive NZ choices."
      },
      "defensive_profile": {
        "source_fields": [
          "systems_profile.defensive_collapse",
          "physicality_profile.net_front_battle_level"
        ],
        "target_fields": [
          "team_strategies.defensive_pressure",
          "team_strategies.defensive_strategy"
        ],
        "logic_hint": "High collapse + high net-front battles favour Protect Net + Collapsing or Staggered. Lower collapse can support Contain Puck with more aggressive DZ structures."
      },
      "trap_slider_profile": {
        "source_fields": [
          "systems_profile.neutral_zone_trap_strength",
          "event_profile.event_rate",
          "event_profile.turtle_level_with_lead"
        ],
        "target_field": "team_strategies.trap_slider",
        "logic_hint": "High trap_strength + low event_rate + high turtle_level_with_lead => more trap-biased slider. Lower values push toward balanced or forecheck-biased slider."
      },
      "physicality_adjustments": {
        "source_fields": [
          "physicality_profile.overall_physicality",
          "physicality_profile.net_front_battle_level",
          "physicality_profile.board_battle_level"
        ],
        "target_fields": [
          "matchup_plan.line_usage_notes",
          "preferred_lockdown_units"
        ],
        "logic_hint": "High physicality and battle levels favour tougher lines and D-pairs in shutdown situations and encourage more emphasis on net-front clearance and wall work."
      },
      "goalie_attack_plan": {
        "source_fields": [
          "goalie_profile.style",
          "goalie_profile.rebound_control",
          "goalie_profile.low_shot_rebound_threat",
          "goalie_profile.high_glove_threat",
          "goalie_profile.high_blocker_threat"
        ],
        "target_field": "offensive_focus.goalie_exploit_plan",
        "logic_hint": "Low rebound_control and high low_shot_rebound_threat favour low shots and crash-the-net strategies. High glove or blocker threats influence shot targeting and one-timer selection."
      },
      "special_teams_bias": {
        "source_fields": [
          "special_teams_profile.pp_shooting_bias",
          "special_teams_profile.pp_seam_hunting",
          "special_teams_profile.pk_aggression",
          "special_teams_profile.pk_box_collapse"
        ],
        "target_fields": [
          "special_teams_plan.powerplay_focus",
          "special_teams_plan.penalty_kill_focus"
        ],
        "logic_hint": "High PP seam_hunting from opponent favours tighter box and seam denial. High PK aggression from opponent favours quick puck movement and fake shots to open seams."
      }
    }
  },
  "matchup_integration": {
    "include_scout_fields_in_matchup_cards": true,
    "exposed_fields": {
      "systems_profile": [
        "forecheck_pressure",
        "neutral_zone_trap_strength",
        "defensive_collapse"
      ],
      "goalie_profile": [
        "style",
        "rebound_control",
        "low_shot_rebound_threat"
      ],
      "physicality_profile": [
        "overall_physicality",
        "net_front_battle_level"
      ],
      "event_profile": [
        "event_rate",
        "comeback_push_level",
        "turtle_level_with_lead"
      ],
      "tendency_flags": [
        "curl_shooter_present",
        "net_front_tip_specialist",
        "east_west_pp_playmaker"
      ]
    },
    "notes": "These fields should appear as concise bullet points on matchup cards to inform line matching and lockdown/comeback modes."
  },
  "runtime_snapshot_integration": {
    "embed_scout_context": true,
    "fields_to_embed": [
      "archetype_hint",
      "systems_profile.neutral_zone_trap_strength",
      "systems_profile.defensive_collapse",
      "goalie_profile.style",
      "goalie_profile.rebound_control",
      "physicality_profile.overall_physicality",
      "event_profile.event_rate",
      "tendency_flags.curl_shooter_present",
      "tendency_flags.net_front_tip_specialist"
    ],
    "notes": "Runtime snapshots should record key scouting context used when the gameplan was generated so future reviews can trace back results to opponent tendencies.",
    "confidence_handling": {
      "min_confidence_for_full_use": 0.8,
      "behaviour_below_min_confidence": "Use archetype defaults first, then treat scout pack data as soft hints only.",
      "field_path_for_confidence": "integration.confidence_score"
    }
  },
  "archetype_alignment": {
    "notes": "These hints ensure OpponentScoutPack and OpponentArchetypeMap stay in sync conceptually.",
    "rules": [
      {
        "archetype_id": "trap_low_event",
        "expected_traits": {
          "systems_profile.neutral_zone_trap_strength_min": 4,
          "event_profile.event_rate_max": 3
        }
      },
      {
        "archetype_id": "chaos_rush",
        "expected_traits": {
          "systems_profile.forecheck_pressure_min": 4,
          "systems_profile.rush_offence_min": 4,
          "event_profile.event_rate_min": 4
        }
      },
      {
        "archetype_id": "slow_umbrella",
        "expected_traits": {
          "special_teams_profile.pp_seam_hunting_min": 4,
          "special_teams_profile.pp_shooting_bias_min": 4
        }
      }
    ]
  }
}